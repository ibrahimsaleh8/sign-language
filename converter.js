const Keywords = [
  {
    keyword: "البيئة",
    variations: ["بيئة", "بيئه", "البيئه"],
    link: "https://files.catbox.moe/bxewen.mp4",
  },
  {
    keyword: "توثيق",
    variations: ["توثيق"],
    link: "https://files.catbox.moe/pmq54b.mp4",
  },
  {
    keyword: "اجابات نموذجية",
    variations: ["اجابات نموذجية", "اجابات نموذجيه"],
    link: "https://files.catbox.moe/mwh2fo.mp4",
  },
  {
    keyword: "ادوات معملية",
    variations: ["ادوات معمليه", "ادوات معملية"],
    link: "https://files.catbox.moe/rz8pj1.mp4",
  },
  {
    keyword: "انقطاع عن الدراسة",
    variations: ["انقطاع عن الدراسه", "انقطاع عن الدراسة"],
    link: "https://files.catbox.moe/fzktjv.mp4",
  },
  {
    keyword: "مشاركة",
    variations: ["مشاركة", "مشاركه"],
    link: "https://files.catbox.moe/zld6tl.mp4",
  },
  {
    keyword: "باور بوينت",
    variations: ["باور بوينت"],
    link: "https://files.catbox.moe/npjmic.mp4",
  },
  {
    keyword: "برنامج متبادل",
    variations: ["برنامج متبادل"],
    link: "https://files.catbox.moe/9hsp7w.mp4",
  },
  {
    keyword: "تحويل الفلوس",
    variations: ["تحويل الفلوس"],
    link: "https://files.catbox.moe/2p200v.mp4",
  },
  {
    keyword: "تصحيح ذاتي",
    variations: ["تصحيح ذاتي"],
    link: "https://files.catbox.moe/eaesvj.mp4",
  },
  {
    keyword: "تعليم عن بعد",
    variations: ["تعليم عن بعد"],
    link: "https://files.catbox.moe/mahc01.mp4",
  },
  {
    keyword: "جلسات إرشاد",
    variations: ["جلسات إرشاد"],
    link: "https://files.catbox.moe/a8e6lh.mp4",
  },
  {
    keyword: "سوق العمل",
    variations: ["سوق العمل"],
    link: "https://files.catbox.moe/22g1kw.mp4",
  },
  {
    keyword: "مبتكر جامعي",
    variations: ["مبتكر جامعي"],
    link: "https://files.catbox.moe/g5yf4w.mp4",
  },
  {
    keyword: "تحويل من الكلية",
    variations: ["تحويل من الكلية", "تحويل من الكليه"],
    link: "https://files.catbox.moe/qeiiwy.mp4",
  },
  {
    keyword: "أسئلة سنوات سابقة",
    variations: ["أسئلة سنوات سابقة"],
    link: "https://files.catbox.moe/1a598n.mp4",
  },
  {
    keyword: "أعمار",
    variations: ["أعمار"],
    link: "https://files.catbox.moe/dftirn.mp4",
  },
  {
    keyword: "الامتحان صعب",
    variations: ["الامتحان صعب"],
    link: "https://files.catbox.moe/uqqi4j.mp4",
  },
  {
    keyword: "البيئة",
    variations: ["البيئة"],
    link: "https://files.catbox.moe/p2ti9e.mp4",
  },
  {
    keyword: "المحاضره فين",
    variations: ["المحاضره فين"],
    link: "https://files.catbox.moe/j92kiq.mp4",
  },
  {
    keyword: "المقاطعة",
    variations: ["المقاطعة"],
    link: "https://files.catbox.moe/i597u2.mp4",
  },
  {
    keyword: "برنامج إرشادي",
    variations: ["برنامج إرشادي"],
    link: "https://files.catbox.moe/uwlki3.mp4",
  },
  {
    keyword: "برنامج دراسي",
    variations: ["برنامج دراسي"],
    link: "https://files.catbox.moe/36oifb.mp4",
  },
  {
    keyword: "تحديات",
    variations: ["تحديات"],
    link: "https://files.catbox.moe/cg0s37.mp4",
  },
  {
    keyword: "تربيه فنيه",
    variations: ["تربيه فنيه"],
    link: "https://files.catbox.moe/hisz3p.mp4",
  },
  {
    keyword: "تصميم",
    variations: ["تصميم"],
    link: "https://files.catbox.moe/2uq8fx.mp4",
  },
  {
    keyword: "تعدد ثقافي",
    variations: ["تعدد ثقافي"],
    link: "https://files.catbox.moe/hebwic.mp4",
  },
  {
    keyword: "تفاهم دولي",
    variations: ["تفاهم دولي"],
    link: "https://files.catbox.moe/7uvvv0.mp4",
  },
  {
    keyword: "تقاليد",
    variations: ["تقاليد"],
    link: "https://files.catbox.moe/0g30jq.mp4",
  },
  {
    keyword: "تقييم",
    variations: ["تقييم"],
    link: "https://files.catbox.moe/e4o58z.mp4",
  },
  {
    keyword: "تنظيم",
    variations: ["تنظيم"],
    link: "https://files.catbox.moe/ac2fdb.mp4",
  },
  {
    keyword: "تنمية",
    variations: ["تنمية"],
    link: "https://files.catbox.moe/udrzg0.mp4",
  },
  {
    keyword: "جدول مذاكرة",
    variations: ["جدول مذاكرة"],
    link: "https://files.catbox.moe/xwkhc9.mp4",
  },
  {
    keyword: "جدول",
    variations: ["جدول"],
    link: "https://files.catbox.moe/7u26mi.mp4",
  },
  {
    keyword: "جودة",
    variations: ["جودة"],
    link: "https://files.catbox.moe/dz1gcr.mp4",
  },
  {
    keyword: "رياضه",
    variations: ["رياضه"],
    link: "https://files.catbox.moe/cv6eyh.mp4",
  },
  {
    keyword: "زوار",
    variations: ["زوار"],
    link: "https://files.catbox.moe/e553l6.mp4",
  },
  {
    keyword: "ساعات معتمدة",
    variations: ["ساعات معتمدة"],
    link: "https://files.catbox.moe/hljabc.mp4",
  },
  {
    keyword: "سياسات",
    variations: ["سياسات"],
    link: "https://files.catbox.moe/s50yuf.mp4",
  },
  {
    keyword: "صعوبات",
    variations: ["صعوبات"],
    link: "https://files.catbox.moe/6reovh.mp4",
  },
  {
    keyword: "عمل جزئي",
    variations: ["عمل جزئي"],
    link: "https://files.catbox.moe/iqq6aj.mp4",
  },
  {
    keyword: "غضبان",
    variations: ["غضبان"],
    link: "https://files.catbox.moe/43rg3d.mp4",
  },
  {
    keyword: "فائدة",
    variations: ["فائدة"],
    link: "https://files.catbox.moe/dj6nus.mp4",
  },
  {
    keyword: "فئات مختلفة",
    variations: ["فئات مختلفة"],
    link: "https://files.catbox.moe/az6ihq.mp4",
  },
  {
    keyword: "كمبيوتر",
    variations: ["كمبيوتر"],
    link: "https://files.catbox.moe/va2oq4.mp4",
  },
  {
    keyword: "متحف علمي",
    variations: ["متحف علمي"],
    link: "https://files.catbox.moe/tf35vk.mp4",
  },
  {
    keyword: "متحف فني",
    variations: ["متحف فني"],
    link: "https://files.catbox.moe/3dbpyi.mp4",
  },
  {
    keyword: "متحف",
    variations: ["متحف"],
    link: "https://files.catbox.moe/bpbtg2.mp4",
  },
  {
    keyword: "مجلة",
    variations: ["مجلة"],
    link: "https://files.catbox.moe/kpicnw.mp4",
  },
  {
    keyword: "محاكاه علمية",
    variations: ["محاكاه علمية"],
    link: "https://files.catbox.moe/gnp4xp.mp4",
  },
  {
    keyword: "مدارس",
    variations: ["مدارس"],
    link: "https://files.catbox.moe/9poq08.mp4",
  },
  {
    keyword: "مدرس مساعد",
    variations: ["مدرس مساعد"],
    link: "https://files.catbox.moe/fb1x7l.mp4",
  },
  {
    keyword: "مسابقه علمية",
    variations: ["مسابقه علمية"],
    link: "https://files.catbox.moe/uzm8v3.mp4",
  },

  {
    keyword: "مستقبل",
    variations: ["مستقبل"],
    link: "https://files.catbox.moe/o44r9e.mp4",
  },
  {
    keyword: "ترميم",
    variations: ["ترميم"],
    link: "https://files.catbox.moe/jwqf8k.mp4",
  },
  {
    keyword: "جروب كلية",
    variations: ["جروب كلية", "جروب كليه"],
    link: "https://files.catbox.moe/agnlmc.mp4",
  },
  {
    keyword: "عمليه",
    variations: ["عمليه", "عملية"],
    link: "https://files.catbox.moe/o6lqp5.mp4",
  },
  {
    keyword: "مناهج",
    variations: ["مناهج"],
    link: "https://files.catbox.moe/wbf8yu.mp4",
  },
  {
    keyword: "وقت اضافي",
    variations: ["وقت اضافي"],
    link: "https://files.catbox.moe/i4350x.mp4",
  },

  {
    keyword: "شهاده تدريب",
    variations: ["شهاده تدريب", "شهادة تدريب"],
    link: "https://files.catbox.moe/ne1l00.mp4",
  },
  {
    keyword: "مساعده ماليه",
    variations: ["مساعدة ماليه", "مساعده مالية", "مساعدة مالية"],
    link: "https://files.catbox.moe/sx2qqc.mp4",
  },
  {
    keyword: "معرض",
    variations: ["معرض"],
    link: "https://files.catbox.moe/oyj9mi.mp4",
  },
  {
    keyword: "معيد جامعة",
    variations: ["معيد جامعة"],
    link: "https://files.catbox.moe/qhur1m.mp4",
  },
  {
    keyword: "مفيش فلوس",
    variations: ["مفيش فلوس"],
    link: "https://files.catbox.moe/vlyhhr.mp4",
  },
  {
    keyword: "مقرر علاجي",
    variations: ["مقرر علاجي"],
    link: "https://files.catbox.moe/afdr4z.mp4",
  },
  {
    keyword: "ملخص المنهج",
    variations: ["ملخص المنهج"],
    link: "https://files.catbox.moe/osio5e.mp4",
  },
  {
    keyword: "ملخص",
    variations: ["ملخص"],
    link: "https://files.catbox.moe/cvs8jl.mp4",
  },
  {
    keyword: "مناقشة علمية",
    variations: ["مناقشة علمية"],
    link: "https://files.catbox.moe/5uf9tm.mp4",
  },
  {
    keyword: "منهج",
    variations: ["منهج", "مناهج", "المنهج", "المناهج"],
    link: "https://files.catbox.moe/0xbm0i.mp4",
  },
  {
    keyword: "مواد عامة",
    variations: ["مواد عامة", "مادة عامة", "مواد عامه", "مادة عامه"],
    link: "https://files.catbox.moe/z1ubrc.mp4",
  },
  {
    keyword: "نشاط مدرسة",
    variations: ["نشاط مدرسة", "نشاط مدرسه", "أنشطة مدرسية", "نشاطات مدرسية"],
    link: "https://files.catbox.moe/eqkpa8.mp4",
  },
  {
    keyword: "هدف",
    variations: ["هدف", "أهداف", "الهدف", "الأهداف"],
    link: "https://files.catbox.moe/ukdoyw.mp4",
  },
  {
    keyword: "واجب",
    variations: ["واجب", "واجبات", "الواجب", "الواجبات"],
    link: "https://files.catbox.moe/example1.mp4",
  },
  {
    keyword: "اختبار",
    variations: [
      "اختبار",
      "اختبارات",
      "الاختبار",
      "الاختبارات",
      "امتحان",
      "امتحانات",
    ],
    link: "https://files.catbox.moe/example2.mp4",
  },

  {
    keyword: "إثبات وجود",
    variations: ["إثبات وجود"],
    link: "https://files.catbox.moe/ynym33.mp4",
  },
  {
    keyword: "إختبار إلكتروني",
    variations: ["إختبار إلكتروني"],
    link: "https://files.catbox.moe/7dff02.mp4",
  },
  {
    keyword: "اسبوع",
    variations: ["اسبوع"],
    link: "https://files.catbox.moe/5qrc9j.mp4",
  },
  {
    keyword: "إضافة مدخلات",
    variations: ["إضافة مدخلات"],
    link: "https://files.catbox.moe/0fosde.mp4",
  },
  {
    keyword: "إعادة تقييم",
    variations: ["إعادة تقييم"],
    link: "https://files.catbox.moe/xt5fcy.mp4",
  },
  {
    keyword: "إفادة شرف",
    variations: ["إفادة شرف"],
    link: "https://files.catbox.moe/1dej11.mp4",
  },
  {
    keyword: "البيت",
    variations: ["البيت"],
    link: "https://files.catbox.moe/236t4n.mp4",
  },
  {
    keyword: "المساواة",
    variations: ["المساواة"],
    link: "https://files.catbox.moe/wf4fkn.mp4",
  },
  {
    keyword: "انذار دراسة",
    variations: ["انذار دراسة"],
    link: "https://files.catbox.moe/33n8wh.mp4",
  },
  {
    keyword: "اول دفعة",
    variations: ["اول دفعة"],
    link: "https://files.catbox.moe/zd7th4.mp4",
  },
  {
    keyword: "اين مكانك",
    variations: ["اين مكانك"],
    link: "https://files.catbox.moe/reug5b.mp4",
  },
  {
    keyword: "بث مباشر",
    variations: ["بث مباشر"],
    link: "https://files.catbox.moe/yulmfz.mp4",
  },
  {
    keyword: "تأشيرة طالب",
    variations: ["تأشيرة طالب"],
    link: "https://files.catbox.moe/9tin4j.mp4",
  },
  {
    keyword: "تأمين صحي",
    variations: ["تأمين صحي"],
    link: "https://files.catbox.moe/8czwr4.mp4",
  },
  {
    keyword: "تسجيل محاضرات",
    variations: ["تسجيل محاضرات"],
    link: "https://files.catbox.moe/635hjj.mp4",
  },
  {
    keyword: "ثبات إداري",
    variations: ["ثبات إداري"],
    link: "https://files.catbox.moe/m3dpcf.mp4",
  },
  {
    keyword: "جدول امتحانات",
    variations: ["جدول امتحانات"],
    link: "https://files.catbox.moe/0jg5f8.mp4",
  },
  {
    keyword: "سوق دعم",
    variations: ["سوق دعم"],
    link: "https://files.catbox.moe/kbgzen.mp4",
  },
  {
    keyword: "قاموس كلمات",
    variations: ["قاموس كلمات"],
    link: "https://files.catbox.moe/l84aie.mp4",
  },
  {
    keyword: "لوحات",
    variations: ["لوحات"],
    link: "https://files.catbox.moe/jks3mi.mp4",
  },
  {
    keyword: "محاضرة اونلاين",
    variations: ["محاضرة اونلاين"],
    link: "https://files.catbox.moe/99mj20.mp4",
  },
  {
    keyword: "مساحة",
    variations: ["مساحة"],
    link: "https://files.catbox.moe/eyxrco.mp4",
  },
  {
    keyword: "مشغول",
    variations: ["مشغول"],
    link: "https://files.catbox.moe/yy00rx.mp4",
  },
  {
    keyword: "مصداقية بحثية",
    variations: ["مصداقية بحثية"],
    link: "https://files.catbox.moe/m35jn2.mp4",
  },
  {
    keyword: "مقرر إختياري",
    variations: ["مقرر إختياري"],
    link: "https://files.catbox.moe/j8cekv.mp4",
  },
  {
    keyword: "منحه",
    variations: ["منحه"],
    link: "https://files.catbox.moe/j6eq08.mp4",
  },
  {
    keyword: "مواد عامة",
    variations: ["مواد عامة"],
    link: "https://files.catbox.moe/wbrshq.mp4",
  },
  {
    keyword: "مؤلف",
    variations: ["مؤلف"],
    link: "https://files.catbox.moe/hegoxe.mp4",
  },
  {
    keyword: "واجب خطي",
    variations: ["واجب خطي"],
    link: "https://files.catbox.moe/lcn7k6.mp4",
  },
];
// Get DOM elements
const btnConvert = document.querySelector("#convert_text");
const userText = document.querySelector("#textInput");
const signLanguageDisplay = document.getElementById("signLanguageDisplay");

// Function to normalize text for better matching
function normalizeText(text) {
  return text
    .trim()
    .toLowerCase() // Convert to lowercase for case-insensitive matching
    .replace(/[أإآا]/g, "ا") // Normalize Alef variations
    .replace(/ى/g, "ي") // Normalize Ya variations
    .replace(/ة/g, "ه") // Normalize Ta Marbuta
    .replace(/ؤ/g, "و") // Normalize Waw with Hamza
    .replace(/ئ/g, "ي") // Normalize Ya with Hamza
    .replace(/ء/g, "") // Remove Hamza
    .replace(/[ً-ْ]/g, "") // Remove diacritics
    .replace(/\s+/g, " ") // Normalize spaces
    .replace(/[،,]/g, "") // Remove commas
    .replace(/[؟?]/g, "") // Remove question marks
    .replace(/[!]/g, ""); // Remove exclamation marks
}

// Function to calculate similarity between two strings
function calculateSimilarity(str1, str2) {
  const s1 = normalizeText(str1);
  const s2 = normalizeText(str2);

  // If strings are identical after normalization
  if (s1 === s2) return 1;

  // If one string contains the other
  if (s1.includes(s2) || s2.includes(s1)) return 0.9;

  // Calculate word overlap
  const words1 = s1.split(" ");
  const words2 = s2.split(" ");
  const commonWords = words1.filter((word) => words2.includes(word));

  if (commonWords.length > 0) {
    return commonWords.length / Math.max(words1.length, words2.length);
  }

  return 0;
}

// Function to find matching keywords in text
function findMatchingKeywords(text) {
  const normalizedText = normalizeText(text);
  const words = normalizedText.split(" ");

  // First pass: exact matches
  let matches = Keywords.filter((item) => {
    const normalizedKeyword = normalizeText(item.keyword);
    return (
      normalizedText.includes(normalizedKeyword) ||
      item.variations.some((v) => normalizedText.includes(normalizeText(v)))
    );
  });

  // If no exact matches, try fuzzy matching
  if (matches.length === 0) {
    // Different thresholds for different types of matches
    const thresholds = {
      exact: 0.9, // For very close matches
      partial: 0.7, // For partial word matches
      fuzzy: 0.5, // For more lenient matches
    };

    matches = Keywords.filter((item) => {
      // Check main keyword
      const keywordSimilarity = calculateSimilarity(text, item.keyword);

      // Check if it's a very close match
      if (keywordSimilarity >= thresholds.exact) return true;

      // Check if it's a partial match
      if (keywordSimilarity >= thresholds.partial) {
        // Additional check for word boundaries
        const words = normalizedText.split(" ");
        const keywordWords = normalizeText(item.keyword).split(" ");
        const hasWordBoundaryMatch = keywordWords.some((kw) =>
          words.some((w) => w.includes(kw) || kw.includes(w))
        );
        if (hasWordBoundaryMatch) return true;
      }

      // Check variations with more lenient threshold
      return item.variations.some((variation) => {
        const variationSimilarity = calculateSimilarity(text, variation);
        return variationSimilarity >= thresholds.fuzzy;
      });
    });
  }

  // Sort matches by relevance (longer matches first)
  matches.sort((a, b) => {
    const aLength = a.keyword.length;
    const bLength = b.keyword.length;
    return bLength - aLength;
  });

  return matches;
}

// Function to create video element
function createVideoElement(videoUrl) {
  const video = document.createElement("video");
  video.controls = true;
  video.autoplay = true;
  video.muted = true;
  video.style.width = "100%";
  video.style.marginBottom = "10px";

  const source = document.createElement("source");
  source.src = videoUrl;
  source.type = "video/mp4";

  video.appendChild(source);
  return video;
}

// Convert button click handler
btnConvert.onclick = () => {
  const text = userText.value.trim();

  if (text === "") {
    alert("الرجاء إدخال نص للتحويل");
    return;
  }

  // Find matching keywords
  const matches = findMatchingKeywords(text);

  if (matches.length === 0) {
    alert("لم يتم العثور على كلمات مطابقة في النص");
    return;
  }

  // Clear previous content
  signLanguageDisplay.innerHTML = "";

  // Create and append video elements for each match
  matches.forEach((match) => {
    const videoElement = createVideoElement(match.link);
    signLanguageDisplay.appendChild(videoElement);
  });
};
